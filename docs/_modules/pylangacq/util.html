
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pylangacq.util &#8212; PyLangAcq 0.12.0 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pylangacq.util</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">re</span>


<span class="n">CLITIC</span> <span class="o">=</span> <span class="s2">&quot;CLITIC&quot;</span>
<span class="n">ENCODING</span> <span class="o">=</span> <span class="s2">&quot;utf8&quot;</span>
<span class="n">TIMER_MARKER_REG</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\x15-?(\d+)_(\d+)-?\x15&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="clean_utterance"><a class="viewcode-back" href="../../util.html#pylangacq.util.clean_utterance">[docs]</a><span class="k">def</span> <span class="nf">clean_utterance</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="n">phon</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Filter away the CHAT-style annotations in ``utterance``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    utterance : str</span>
<span class="sd">        The utterance as a str</span>
<span class="sd">    phon : bool, optional</span>
<span class="sd">        whether we are handling PhonBank data; defaults to False.</span>
<span class="sd">        If ``True``, words like &quot;xxx&quot; and &quot;yyy&quot; won&#39;t be removed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Function tested with the following CHILDES datasets:</span>
    <span class="c1"># 1) Brent, Brown, HSLLD, Kuczaj, MacWhinney, Valian in Eng-NA-MOR</span>
    <span class="c1"># 2) YipMatthews in Biling</span>
    <span class="c1"># 3) LeeWongLeung in EastAsian/Cantonese</span>
    <span class="c1"># 4) CromptonPater, Goad, Inkelas, and Providence in PhonBank English</span>

    <span class="c1"># *** At the end of each step, apply remove_extra_spaces(). ***</span>

    <span class="c1"># Step 1: Remove unwanted scope elements (only the very certain cases)</span>
    <span class="c1"># [= whatever] for explanations</span>
    <span class="c1"># [x how_many_times] for collapses</span>
    <span class="c1"># [+ whatever] for actions etc</span>
    <span class="c1"># [* whatever] for error coding</span>
    <span class="c1"># [=? whatever] for uncertain transcriptions</span>
    <span class="c1"># [=! whatever] for actions etc</span>
    <span class="c1"># [% whatever] for random noises?</span>
    <span class="c1"># [- language_name] for using a non-dominant language</span>
    <span class="c1"># [^ whatever] for complex local events</span>
    <span class="c1"># whatever for audio/video time stamps? the  character is 0x15</span>
    <span class="c1"># [&lt;] and [&gt;] for overlapping, including [&lt;1], [&gt;2] etc with numbers</span>
    <span class="c1"># (2.), (3.5) etc for pauses</span>
    <span class="c1"># [%act: whatever] for actions etc</span>

    <span class="c1"># [?] for best guess</span>
    <span class="c1"># ‹ and › used in conjunction with [?]</span>
    <span class="c1"># [!] for stressing</span>

    <span class="c1"># &quot;[*] [/&quot; replaced by &quot;[/&quot;</span>
    <span class="c1"># &quot;] [*]&quot; replaced by &quot;]&quot;</span>

    <span class="c1"># print(&#39;utterance:&#39;, utterance, type(utterance))</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[= [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[x \d+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[\+ [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[\* [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[=\? [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[=! [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[% [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[- [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[\^ [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^]+?&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[&lt;\d?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[&gt;\d?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\(\d+?\.?\d*?\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[</span><span class="si">%a</span><span class="s2">ct: [^\[]+?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[\?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[\!\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;‹&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;›&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[\*\] \[/&quot;</span><span class="p">,</span> <span class="s2">&quot;[/&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\] \[\*\]&quot;</span><span class="p">,</span> <span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">remove_extra_spaces</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>
    <span class="c1"># print(&#39;step 1:&#39;, utterance)</span>

    <span class="c1"># Step 2: Pad elements with spaces to avoid human transcription errors</span>
    <span class="c1"># If utterance has these delimiters: [ ]</span>
    <span class="c1"># then pad them with extra spaces to avoid errors in transcriptions</span>
    <span class="c1"># like &quot;movement[?]&quot; (--&gt; &quot;movement [?]&quot;)</span>
    <span class="c1">#</span>
    <span class="c1"># If utterance has:</span>
    <span class="c1">#     &lt; &gt; (left and right angle brackets), excluding &quot;+&lt;&quot; (lazy overlap)</span>
    <span class="c1">#     “ (beginning quote)</span>
    <span class="c1">#     ” (ending quote)</span>
    <span class="c1">#     , (comma)</span>
    <span class="c1">#     ? (question mark)</span>
    <span class="c1">#     . (period) &lt;-- commented out at the moment</span>
    <span class="c1">#     (.) (short pause)</span>
    <span class="c1"># then pad them with extra spaces.</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot; &lt;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\+ &lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;+&lt;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt; &quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[&quot;</span><span class="p">,</span> <span class="s2">&quot; [&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\]&quot;</span><span class="p">,</span> <span class="s2">&quot;] &quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;“&quot;</span><span class="p">,</span> <span class="s2">&quot; “ &quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;”&quot;</span><span class="p">,</span> <span class="s2">&quot; ” &quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot; , &quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>  <span class="c1"># works together with next line</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\+ ,&quot;</span><span class="p">,</span> <span class="s2">&quot;+,&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^\[\./!]\?&quot;</span><span class="p">,</span> <span class="s2">&quot; ? &quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="c1"># utterance = re.sub(&#39;[^\(\[\.\+]\.&#39;, &#39; . &#39;, utterance)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\(\.\)&quot;</span><span class="p">,</span> <span class="s2">&quot; (.) &quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">remove_extra_spaces</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>
    <span class="c1"># print(&#39;step 2:&#39;, utterance)</span>

    <span class="c1"># Step 3:</span>
    <span class="c1"># Handle [/], [//], [///], [/?] for repetitions/reformulation</span>
    <span class="c1">#        [: xx] or [:: xx] for errors</span>
    <span class="c1">#</span>
    <span class="c1"># Discard &quot;xx [/]&quot;, &quot;&lt;xx yy&gt; [/]&quot;, &quot;xx [//]&quot;, &quot;&lt;xx yy&gt; [//]&quot;.</span>
    <span class="c1"># For &quot;zz [: xx]&quot; or &quot;&lt;yy zz&gt; [:: xx]&quot;, keep &quot;xx&quot; and discard the rest.</span>
    <span class="c1">#</span>
    <span class="c1"># Strategies:</span>
    <span class="c1"># 1. Get all matching index pairs for angle brackets &lt; and &gt;.</span>
    <span class="c1"># 2. Delete the unwanted material inside and including these brackets</span>
    <span class="c1">#    plus their signaling annotations (= &quot;[:&quot;, &quot;[::&quot;, &quot;[/]&quot;, &quot;[//]&quot;).</span>
    <span class="c1"># 3. Delete the unwanted words on the left of the signaling annotations.</span>

    <span class="n">angle_brackets_l2r_pairs</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># left-to-right</span>
    <span class="k">for</span> <span class="n">index_</span> <span class="ow">in</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">):</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">utterance</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">utterance</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">utterance</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
                <span class="n">counter</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">angle_brackets_l2r_pairs</span><span class="p">[</span><span class="n">index_</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">break</span>
    <span class="n">angle_brackets_r2l_pairs</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">angle_brackets_l2r_pairs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="n">index_pairs</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># characters bounded by index pairs to be removed</span>

    <span class="c1"># remove &#39; [///]&#39;</span>
    <span class="n">triple_slash_right_indices</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&gt; \[///\]&quot;</span><span class="p">)</span>
    <span class="n">index_pairs</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">triple_slash_right_indices</span><span class="p">]</span>

    <span class="c1"># remove &#39; [//]&#39;</span>
    <span class="n">double_overlap_right_indices</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&gt; \[//\]&quot;</span><span class="p">)</span>
    <span class="n">index_pairs</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">double_overlap_right_indices</span><span class="p">]</span>

    <span class="c1"># remove &#39; [/]&#39;</span>
    <span class="n">single_overlap_right_indices</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&gt; \[/\]&quot;</span><span class="p">)</span>
    <span class="n">index_pairs</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">single_overlap_right_indices</span><span class="p">]</span>

    <span class="c1"># remove &#39; [/?]&#39;</span>
    <span class="n">slash_question_indices</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&gt; \[/\?\]&quot;</span><span class="p">)</span>
    <span class="n">index_pairs</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">slash_question_indices</span><span class="p">]</span>

    <span class="c1"># remove &#39; [/-]&#39;</span>
    <span class="n">slash_dash_indices</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&gt; \[/\-\]&quot;</span><span class="p">)</span>
    <span class="n">index_pairs</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">slash_dash_indices</span><span class="p">]</span>

    <span class="c1"># remove &#39; [::&#39;</span>
    <span class="n">double_error_right_indices</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&gt; \[::&quot;</span><span class="p">)</span>
    <span class="n">index_pairs</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">double_error_right_indices</span><span class="p">]</span>

    <span class="c1"># remove &#39; [:&#39;</span>
    <span class="n">single_error_right_indices</span> <span class="o">=</span> <span class="n">find_indices</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&gt; \[: &quot;</span><span class="p">)</span>
    <span class="n">index_pairs</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">single_error_right_indices</span><span class="p">]</span>

    <span class="n">right_indices</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">double_overlap_right_indices</span>
        <span class="o">+</span> <span class="n">single_overlap_right_indices</span>
        <span class="o">+</span> <span class="n">double_error_right_indices</span>
        <span class="o">+</span> <span class="n">single_error_right_indices</span>
        <span class="o">+</span> <span class="n">triple_slash_right_indices</span>
        <span class="o">+</span> <span class="n">slash_question_indices</span>
        <span class="o">+</span> <span class="n">slash_dash_indices</span>
    <span class="p">)</span>

    <span class="n">index_pairs</span> <span class="o">=</span> <span class="n">index_pairs</span> <span class="o">+</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">angle_brackets_r2l_pairs</span><span class="p">[</span><span class="n">right</span><span class="p">],</span> <span class="n">right</span><span class="p">)</span> <span class="k">for</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">right_indices</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">indices_to_ignore</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="ow">in</span> <span class="n">index_pairs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">indices_to_ignore</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">new_utterance</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">utterance</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">indices_to_ignore</span><span class="p">:</span>
            <span class="n">new_utterance</span> <span class="o">+=</span> <span class="n">utterance</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">new_utterance</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S+? \[/\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S+? \[//\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S+? \[///\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S+? \[/\?\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S+? \[/\-\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S+? \[::&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S+? \[:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">remove_extra_spaces</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>
    <span class="c1"># print(&#39;step 3:&#39;, utterance)</span>

    <span class="c1"># Step 4: Remove unwanted symbols</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;“&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>
    <span class="n">utterance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;”&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">utterance</span><span class="p">)</span>

    <span class="n">utterance</span> <span class="o">=</span> <span class="n">remove_extra_spaces</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>

    <span class="c1"># Step 5: Split utterance by spaces and determine whether to keep items.</span>

    <span class="n">escape_prefixes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;[?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[/&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[&lt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[:&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[!&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[*&quot;</span><span class="p">,</span>
        <span class="s1">&#39;+&quot;&#39;</span><span class="p">,</span>
        <span class="s2">&quot;+,&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&lt;&amp;&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">escape_words</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;++&quot;</span><span class="p">,</span> <span class="s2">&quot;+&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;+^&quot;</span><span class="p">,</span> <span class="s2">&quot;(.)&quot;</span><span class="p">,</span> <span class="s2">&quot;(..)&quot;</span><span class="p">,</span> <span class="s2">&quot;(...)&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">}</span>
    <span class="n">keep_prefixes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;+&quot;/&#39;</span><span class="p">,</span> <span class="s2">&quot;+,/&quot;</span><span class="p">,</span> <span class="s1">&#39;+&quot;.&#39;</span><span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">phon</span><span class="p">:</span>
        <span class="n">escape_words</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;xxx&quot;</span><span class="p">,</span> <span class="s2">&quot;yyy&quot;</span><span class="p">,</span> <span class="s2">&quot;www&quot;</span><span class="p">,</span> <span class="s2">&quot;xxx:&quot;</span><span class="p">,</span> <span class="s2">&quot;yyy:&quot;</span><span class="p">})</span>
        <span class="n">escape_prefixes</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;&amp;&quot;</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">escape_words</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;,&quot;</span><span class="p">})</span>
        <span class="n">escape_prefixes</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;0&quot;</span><span class="p">})</span>

    <span class="n">words</span> <span class="o">=</span> <span class="n">utterance</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">new_words</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\A&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>  <span class="c1"># remove beginning &lt;</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&gt;\Z&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>  <span class="c1"># remove final &gt;</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\]\Z&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>  <span class="c1"># remove final ]</span>

        <span class="n">not_an_escape_word</span> <span class="o">=</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">escape_words</span>
        <span class="n">no_escape_prefix</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">escape_prefixes</span><span class="p">)</span>
        <span class="n">has_keep_prefix</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keep_prefixes</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">not_an_escape_word</span> <span class="ow">and</span> <span class="n">no_escape_prefix</span><span class="p">)</span> <span class="ow">or</span> <span class="n">has_keep_prefix</span><span class="p">:</span>
            <span class="n">new_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

    <span class="c1"># print(&#39;step 5:&#39;, remove_extra_spaces(&#39; &#39;.join(new_words)))</span>

    <span class="k">return</span> <span class="n">remove_extra_spaces</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_words</span><span class="p">))</span></div>


<div class="viewcode-block" id="get_time_marker"><a class="viewcode-back" href="../../util.html#pylangacq.util.get_time_marker">[docs]</a><span class="k">def</span> <span class="nf">get_time_marker</span><span class="p">(</span><span class="n">utterance</span><span class="p">):</span>  <span class="c1"># TODO write tests this function</span>
    <span class="sd">&quot;&quot;&quot;Get the timer marker in this utterance.</span>

<span class="sd">    Time marker provides the start and end times (in milliseconds)</span>
<span class="sd">    for a segment in a digitized video or audio file. For example:</span>
<span class="sd">        ·0_1073·</span>
<span class="sd">    &#39;·&#39; is ASCII CODE 21 (0x15), for NAK (Negative Acknowledgement)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    utterance : str</span>
<span class="sd">        The raw utterance</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple of (int, int)</span>
<span class="sd">        The start and end times (in milliseconds) for this utterance</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If the option “multiple” is selected in the @Options field, then these &#39;·&#39;</span>
<span class="sd">    bullets may also occur within utterances. However, this function only</span>
<span class="sd">    returns one timer marker. (See https://talkbank.org/manuals/CHAT.pdf)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">TIMER_MARKER_REG</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="n">time_marker</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_marker</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_marker</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Utterance does not have a standard time marker: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">utterance</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_participant_code"><a class="viewcode-back" href="../../util.html#pylangacq.util.get_participant_code">[docs]</a><span class="k">def</span> <span class="nf">get_participant_code</span><span class="p">(</span><span class="n">tier_marker_seq</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the participant code from a tier marker set.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tier_marker_seq : iterable of str</span>
<span class="sd">        A sequence of tier markers like ``{&#39;CHI&#39;, &#39;%mor&#39;, &#39;%gra&#39;}``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A participant code, e.g., ``&#39;CHI&#39;``.</span>
<span class="sd">        Return ``None`` if no participant code is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tier_marker</span> <span class="ow">in</span> <span class="n">tier_marker_seq</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tier_marker</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">tier_marker</span>
    <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="clean_word"><a class="viewcode-back" href="../../util.html#pylangacq.util.clean_word">[docs]</a><span class="k">def</span> <span class="nf">clean_word</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Clean the word.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    word : str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_word</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">word</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;@&quot;</span> <span class="ow">in</span> <span class="n">new_word</span><span class="p">:</span>
        <span class="n">new_word</span> <span class="o">=</span> <span class="n">new_word</span><span class="p">[:</span> <span class="n">new_word</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">new_word</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">):</span>
        <span class="n">new_word</span> <span class="o">=</span> <span class="n">new_word</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">new_word</span></div>


<div class="viewcode-block" id="convert_date_to_tuple"><a class="viewcode-back" href="../../util.html#pylangacq.util.convert_date_to_tuple">[docs]</a><span class="k">def</span> <span class="nf">convert_date_to_tuple</span><span class="p">(</span><span class="n">date_str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert ``date_str`` to (year, month, day).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    date_str : str</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (int, int, int)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; convert_date_to_tuple(&#39;01-FEB-2016&#39;)</span>
<span class="sd">    (2016, 2, 1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">day_str</span><span class="p">,</span> <span class="n">month_str</span><span class="p">,</span> <span class="n">year_str</span> <span class="o">=</span> <span class="n">date_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="n">day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">day_str</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">year_str</span><span class="p">)</span>

        <span class="n">month_to_int</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;JAN&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;FEB&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;MAR&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;APR&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;MAY&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;JUN&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;JUL&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s2">&quot;AUG&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;SEP&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
            <span class="s2">&quot;OCT&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;NOV&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
            <span class="s2">&quot;DEC&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">month</span> <span class="o">=</span> <span class="n">month_to_int</span><span class="p">[</span><span class="n">month_str</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="get_lemma_from_mor"><a class="viewcode-back" href="../../util.html#pylangacq.util.get_lemma_from_mor">[docs]</a><span class="k">def</span> <span class="nf">get_lemma_from_mor</span><span class="p">(</span><span class="n">mor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract lemma from ``mor``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mor : tuple(str, str, str)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lemma</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mor</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="n">lemma</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">lemma</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lemma</span></div>


<div class="viewcode-block" id="remove_extra_spaces"><a class="viewcode-back" href="../../util.html#pylangacq.util.remove_extra_spaces">[docs]</a><span class="k">def</span> <span class="nf">remove_extra_spaces</span><span class="p">(</span><span class="n">inputstr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove extra spaces in *inputstr* so that there are only single spaces.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inputstr : str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="s2">&quot;  &quot;</span> <span class="ow">in</span> <span class="n">inputstr</span><span class="p">:</span>
        <span class="n">inputstr</span> <span class="o">=</span> <span class="n">inputstr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inputstr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></div>


<div class="viewcode-block" id="find_indices"><a class="viewcode-back" href="../../util.html#pylangacq.util.find_indices">[docs]</a><span class="k">def</span> <span class="nf">find_indices</span><span class="p">(</span><span class="n">longstr</span><span class="p">,</span> <span class="n">substring</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find all indices of non-overlapping ``substring`` in ``longstr``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    longstr : str</span>
<span class="sd">    substring : str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list of int</span>
<span class="sd">        List of indices of the long string for where substring occurs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span> <span class="n">longstr</span><span class="p">)]</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">PyLangAcq</a></h1>










<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">PyLangAcq: Language Acquisition Research in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../download.html">Download and install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../read.html">Reading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metadata.html">Accessing metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transcriptions.html">Transcriptions and annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devmeasures.html">Developmental measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../freq.html">Word frequency and ngrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Library reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015-2021, <a href="https://jacksonllee.com/">Jackson L. Lee</a> | PyLangAcq 0.12.0 | Documentation last updated on March 11, 2021.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>